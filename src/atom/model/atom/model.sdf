<?xml version='1.0'?>
<sdf version='1.4'>
    <model name="atom">
        <static>false</static>

        <!-- Make Chassis of Bot -->
        <link name="chassis">
            <pose>0.536448 -0.130302 0.066802 0 0 0</pose>
            <inertial>
                <mass>29.9371</mass>
                <inertia> <!-- inertias are tricky to compute -->
                    <!-- http://gazebosim.org/tutorials?tut=inertia&cat=build_robot -->
                    <ixx>1.699</ixx>       <!-- for a box: ixx = 0.083 * mass * (y*y + z*z) -->
                    <ixy>0.0</ixy>         <!-- for a box: ixy = 0 -->
                    <ixz>0.0</ixz>         <!-- for a box: ixz = 0 -->
                    <iyy>4.022</iyy>       <!-- for a box: iyy = 0.083 * mass * (x*x + z*z) -->
                    <iyz>0.0</iyz>         <!-- for a box: iyz = 0 -->
                    <izz>4.170</izz>       <!-- for a box: izz = 0.083 * mass * (x*x + y*y) -->
                </inertia>
            </inertial>
            <collision name="collision">
                <geometry>
                    <box>
                        <size> 1.143 0.6096 0.5588 </size>
                    </box>
                </geometry>
            </collision>

            <visual name="visual">
                <geometry>
                    <box>
                        <size> 1.143 0.6096 0.5588 </size>
                    </box>
                </geometry>

                <material>
                    <script>
                        <uri>model://atom/materials/scripts/repeated.material</uri>
                        <name>Atom</name>
                    </script>
                </material>

            </visual>
            
        </link>

        <!-- Middle Wheel Back -->
        <link name="middle_wheel_back">
            <pose> -0.2 0.3 0.1 0 1.5707 1.5707</pose>
            <inertial>
                <mass>5.0</mass>
                <inertia> <!-- inertias are tricky to compute -->
                    <!-- http://gazebosim.org/tutorials?tut=inertia&cat=build_robot -->
                    <ixx>0.1</ixx>
                    <ixy>0.0</ixy>
                    <ixz>0.0</ixz>
                    <iyy>0.1</iyy>
                    <iyz>0.0</iyz>
                    <izz>0.1</izz>
                </inertia>
            </inertial>
            <visual name="visual">
                <geometry>
                    <cylinder>
                        <radius> 0.1 </radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
                <material> <!-- Wheel material -->
                    <ambient>0.1 0.1 0.1 1</ambient>
                    <diffuse>0.1 0.1 0.2 1</diffuse>
                    <specular>0 0 0 0</specular>
                    <emissive>0 0 0 1</emissive>
                </material> <!-- End wheel material -->
            </visual>
            <collision name="collision">
                <geometry>
                    <cylinder>
                        <radius> 0.1 </radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
            </collision>
            
        </link>

        <!-- Right Wheel Front -->
        <link name="right_wheel_front">
            <pose> 0.2 0.3 0.1 0 1.5707 1.5707</pose>
            <inertial>
                <mass>5.0</mass>
                <inertia> <!-- inertias are tricky to compute -->
                    <!-- http://gazebosim.org/tutorials?tut=inertia&cat=build_robot -->
                    <ixx>0.1</ixx>
                    <ixy>0.0</ixy>
                    <ixz>0.0</ixz>
                    <iyy>0.1</iyy>
                    <iyz>0.0</iyz>
                    <izz>0.1</izz>
                </inertia>
            </inertial>
            <visual name="visual">
                <geometry>
                    <cylinder>
                        <radius> 0.1 </radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
                <material> <!-- Wheel material -->
                    <ambient>0.1 0.1 0.1 1</ambient>
                    <diffuse>0.1 0.1 0.2 1</diffuse>
                    <specular>0 0 0 0</specular>
                    <emissive>0 0 0 1</emissive>
                </material> <!-- End wheel material -->
            </visual>
            <collision name="collision">
                <geometry>
                    <cylinder>
                        <radius> 0.1 </radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
            </collision>
        </link>

        <!-- Left Wheel Front -->
        <link name="left_wheel_front">
            <pose> 0.2 -0.3 0.1 0 1.5707 1.5707</pose>
            <inertial>
                <mass>5.0</mass>
                <inertia> <!-- inertias are tricky to compute -->
                    <!-- http://gazebosim.org/tutorials?tut=inertia&cat=build_robot -->
                    <ixx>0.1</ixx>
                    <ixy>0.0</ixy>
                    <ixz>0.0</ixz>
                    <iyy>0.1</iyy>
                    <iyz>0.0</iyz>
                    <izz>0.1</izz>
                </inertia>
            </inertial>
            <visual name="visual">
                <geometry>
                    <cylinder>
                        <radius> 0.1 </radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
                <material> <!-- Wheel material -->
                    <ambient>0.1 0.1 0.1 1</ambient>
                    <diffuse>0.1 0.1 0.2 1</diffuse>
                    <specular>0 0 0 0</specular>
                    <emissive>0 0 0 1</emissive>
                </material> <!-- End wheel material -->
            </visual>
            <collision name="collision">
                <geometry>
                    <cylinder>
                        <radius> 0.1 </radius>
                        <length>0.05</length>
                    </cylinder>
                </geometry>
            </collision>
        </link>

        <!-- Define Joints -->
        <!-- Middle Wheel Joint Back-->
        <joint type="revolute" name="middle_wheel_hinge_back">
            <pose>0 0 0.03 0 0 0</pose>
            <child>middle_wheel_back</child>
            <parent>chassis</parent>
            <axis>
                <xyz>0 1 0</xyz>
            </axis>
        </joint>

        <!-- Right Wheel Joint Front-->
        <joint type="revolute" name="right_wheel_hinge_front">
            <pose>0 0 0.03 0 0 0</pose>
            <child>right_wheel_front</child>
            <parent>chassis</parent>
            <axis>
                <xyz>0 1 0</xyz>
            </axis>
        </joint>

        <!-- Left Wheel Joint Front-->
        <joint type="revolute" name="left_wheel_hinge_front">
            <pose>0 0 -0.03 0 0 0</pose>
            <child>left_wheel_front</child>
            <parent>chassis</parent>
            <axis>
                <xyz>0 1 0</xyz>
            </axis>
        </joint>

        <!-- Camera -->
        <link name="camera_link">
            <pose>0.26 0 0.15 0 0 0</pose>

            <visual name="visual">
                <geometry>
                    <box>
                        <size>0.05 0.05 0.05</size>
                    </box>
                </geometry>
            </visual>

            <collision name="collision">
                <geometry>
                    <box>
                        <size>0.05 0.05 0.05</size>
                    </box>
                </geometry>
            </collision>

            <sensor type="camera" name="camera1">
                <update_rate>15.0</update_rate>
                <camera name="head">
                    <horizontal_fov>1.91986</horizontal_fov>
                    <image>
                        <width>2560</width>
                        <height>720</height>
                        <format>R8G8B8</format>
                    </image>
                    <clip>
                        <near>0.02</near>
                        <far>300</far>
                    </clip>
                </camera>
                <always_on>1</always_on>
                <visualize>1</visualize>
                <plugin name="camera_plugin" filename="libgazebo_ros_openni_kinect.so">
                    <baseline>0.2</baseline>
                    <alwaysOn>true</alwaysOn>
                    <!-- Keep this zero, update_rate in the parent <sensor> tag
                      will control the frame rate. -->
                    <updateRate>0.0</updateRate>
                    <cameraName>camera_ir</cameraName>
                    <imageTopicName>/camera/color/image_raw</imageTopicName>
                    <cameraInfoTopicName>/camera/color/camera_info</cameraInfoTopicName>
                    <depthImageTopicName>/camera/depth/image_raw</depthImageTopicName>
                    <depthImageCameraInfoTopicName>/camera/depth/camera_info</depthImageCameraInfoTopicName>
                    <pointCloudTopicName>/camera/depth/points</pointCloudTopicName>
                    <frameName>camera_link_optical</frameName>
                    <pointCloudCutoff>0.3</pointCloudCutoff>
                    <pointCloudCutoffMax>20</pointCloudCutoffMax>
                    <distortionK1>0</distortionK1>
                    <distortionK2>0</distortionK2>
                    <distortionK3>0</distortionK3>
                    <distortionT1>0</distortionT1>
                    <distortionT2>0</distortionT2>
                    <CxPrime>0</CxPrime>
                    <Cx>0</Cx>
                    <Cy>0</Cy>
                    <focalLength>0</focalLength>
                    <hackBaseline>0</hackBaseline>
                </plugin>
            </sensor>
        </link>

        <!-- Camera Joint -->
        <joint type="fixed" name="camera_joint" >
            <parent>chassis</parent>
            <child>camera_link</child>
            <axis>
                <xyz>0 1 0</xyz>
            </axis>
        </joint>

        <!-- Project center to the ground -->
        <link name="robot_footprint"></link>

        <!-- Plugin -->
        <plugin name="differential_drive_controller" filename="libgazebo_ros_diff_drive.so">
            <!-- Plugin update rate in Hz -->
            <updateRate>10.0</updateRate>
            <!-- Name of left joint, defaults to `left_joint` -->
            <leftJoint>left_wheel_hinge_front</leftJoint>
            <!-- Name of right joint, defaults to `right_joint` -->
            <rightJoint>right_wheel_hinge_front</rightJoint>
            <!-- The distance from the center of one wheel to the other, in meters, defaults to 0.34 m -->
            <wheelSeparation>0.3548</wheelSeparation>
            <!-- Diameter of the wheels, in meters, defaults to 0.15 m -->
            <wheelDiameter>0.314452</wheelDiameter>
            <!-- Wheel acceleration, in rad/s^2, defaults to 0.0 rad/s^2 -->
            <wheelAcceleration>1.0</wheelAcceleration>
            <!-- Maximum torque which the wheels can produce, in Nm, defaults to 5 Nm -->
            <wheelTorque>20</wheelTorque>
            <!-- Topic to receive geometry_msgs/Twist message commands, defaults to `cmd_vel` -->
            <commandTopic>cmd_vel</commandTopic>
            <!-- Topic to publish nav_msgs/Odometry messages, defaults to `odom` -->
            <odometryTopic>odom</odometryTopic>
            <!-- Odometry frame, defaults to `odom` -->
            <odometryFrame>odom</odometryFrame>
            <!-- Robot frame to calculate odometry from, defaults to `base_footprint` -->
            <robotBaseFrame>robot_footprint</robotBaseFrame>
            <!-- Odometry source, 0 for ENCODER, 1 for WORLD, defaults to WORLD -->
            <odometrySource>1</odometrySource>
            <!-- Set to true to publish transforms for the wheel links, defaults to false -->
            <publishWheelTF>true</publishWheelTF>
            <!-- Set to true to publish transforms for the odometry, defaults to true -->
            <publishOdom>true</publishOdom>
            <!-- Set to true to publish sensor_msgs/JointState on /joint_states for the wheel joints, defaults to false -->
            <publishWheelJointState>true</publishWheelJointState>
            <!-- Set to true to swap right and left wheels, defaults to true -->
            <legacyMode>false</legacyMode>
        </plugin>
    </model>
</sdf>